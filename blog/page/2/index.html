
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>make clean; make</title>
  <meta name="author" content="pankona">

  
  <meta name="description" content="Code Review Best Practices - Kevin London&#39;s blog の日本語訳を作成した。 Code Review Best Practices 日本語翻訳 コードレビューのやり方に関しての記事であるが、分かりやすいしフムフムと感じる内容だったため、 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://pankona.github.io/blog/page/2">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="make clean; make" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-48476608-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">make clean; make</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:pankona.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/07/31/code-review-best-practices-jp-translation/">Code Review Best Practices を日本語訳した</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-07-31T10:36:04+00:00" pubdate data-updated="true">Jul 31<span>st</span>, 2015</time>
        
           | <a href="/blog/2015/07/31/code-review-best-practices-jp-translation/#disqus_thread"
             data-disqus-identifier="http://pankona.github.io/blog/2015/07/31/code-review-best-practices-jp-translation/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://kevinlondon.com/2015/05/05/code-review-best-practices.html">Code Review Best Practices - Kevin London&#39;s blog</a> の日本語訳を作成した。</p>

<p><a href="http://pankona.github.io/CodeReviewBestPractices_JP_Translation/">Code Review Best Practices 日本語翻訳</a></p>

<p>コードレビューのやり方に関しての記事であるが、分かりやすいしフムフムと感じる内容だったため、<br>
本人に許可をいただいて、翻訳、掲載をさせていただいた。<br>
ありがとう、ケビンさん。</p>

<p>おかしい点、改善点にお気づきの方がいらっしゃれば、issue登録、pull request、なんでもいいので連絡いただけると嬉しい。<br>
リポジトリは<a href="https://github.com/pankona/CodeReviewBestPractices_JP_Translation">こちら</a></p>

<p>実は<a href="http://postd.cc/code-review-best-practices/">POSTDに同じ記事を訳したもの</a>があることが分かったのだが、、、<br>
まあいくつあってもいいかな、等と思いつつ。ちなみに訳はほとんど同じだった。</p>

<p>この手のものは英語のままでいいと思う気持ちがある反面、<br>
やっぱり日本人は日本語のほうが速く読める人が多いだろうし、一定の価値はあるかな、等と思うところである。</p>

<p>記事の中で印象深かったのは、*Compliment / reinforce good practices* の部分である。</p>

<p>平たく言えば、コードレビューで見つけた良いところを褒めていけ、という内容。<br>
コードレビューではとかく指摘を探すことに終始しがちであるが、<br>
確かに、褒めるというかイイネというか＋１というか、をしていくことで、<br>
いい空気、もっといいコード書いてやろう的なモチベーションアップ、とか そういう効果もあるんじゃないかと思ったりもする。<br>
ギスギスしがちなコードレビューの現場にはオススメ。私もやっていきます。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/22/travis-ci-with-deploygate/">Cocos2d-x + Travis CI + DeployGate</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-22T10:25:11+00:00" pubdate data-updated="true">Apr 22<span>nd</span>, 2015</time>
        
           | <a href="/blog/2015/04/22/travis-ci-with-deploygate/#disqus_thread"
             data-disqus-identifier="http://pankona.github.io/blog/2015/04/22/travis-ci-with-deploygate/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://pankona.github.io/blog/2015/04/19/cocos-with-travisci/">前回</a>の記事にて、cocos2d-xでのアプリ作成とTravis CIを連携させるとこまでいった。<br>
今回は成果物であるAPKをDeployGateにアップロードするところについて書き留めておく。</p>

<h2 id="だいたいのやり方">だいたいのやり方</h2>

<ul>
<li>ビルドが成功したら<code>curl</code>コマンドにてDeployGateにAPKをアップロードする。</li>
<li>アップロードにあたってDeployGateのAPI Keyが必要になる。DeployGateにログインして個人設定的なところを見れば載っている。</li>
<li>API Keyは.travis.ymlに書くことになるが、そのまま載せちゃうとセキュリティ的に問題なので暗号化する。

<ul>
<li>暗号化には<code>travis</code>コマンドを用いる。</li>
</ul></li>
</ul>

<h2 id="ちょっと細かいやり方">ちょっと細かいやり方</h2>

<p>まずはAPKアップロード成功後の.travis.ymlを載せておく。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>language: android
</span><span class='line'>
</span><span class='line'># Handle git submodules yourself
</span><span class='line'>git:
</span><span class='line'>    submodules: false
</span><span class='line'>
</span><span class='line'>env:
</span><span class='line'>  global:
</span><span class='line'>    secure: "TeSR8JLJd2Z0erCxcgLinC+me5SfwpgcCNwiTsqXn09erOgos2+mUbVQaSyo7Bw4OF4TmNpejX+jETd/lL4fTiWRDw6NW/cqEelk57fXJ5mmf5ey+tB1EkMFwd8x7Fw2vBe4xtO8KeohI6D1Gtu1qTYU9t9x4bhAd4qL15Y5osE="
</span><span class='line'>
</span><span class='line'>install:
</span><span class='line'># NDK configuration
</span><span class='line'>    - printenv
</span><span class='line'>    - echo `pwd`
</span><span class='line'>    - wget http://dl.google.com/android/ndk/android-ndk-r10d-linux-x86_64.bin
</span><span class='line'>    - chmod a+x android-ndk-r10d-linux-x86_64.bin
</span><span class='line'>    - ./android-ndk-r10d-linux-x86_64.bin -y | grep -v Extracting # because log will be too long!
</span><span class='line'>    - export NDK_ROOT=`pwd`/android-ndk-r10d
</span><span class='line'>    - echo $NDK_ROOT
</span><span class='line'>    - export PATH=$PATH:$NDK_ROOT
</span><span class='line'>    - echo $PATH
</span><span class='line'>
</span><span class='line'># Android SDK configuration
</span><span class='line'>    - export ANDROID_SDK_ROOT=/usr/local/android-sdk
</span><span class='line'>    - export PATH=$PATH:$ANDROID_SDK_ROOT/tools:$ANDROID_SDK_ROOT/platform-tools
</span><span class='line'>
</span><span class='line'># git submodule
</span><span class='line'># Use sed to replace the SSH URL with the public URL, then initialize submodules
</span><span class='line'>    - sed -i 's/git@github.com:/https:\/\/github.com\//' .gitmodules
</span><span class='line'>    - git submodule update --init --recursive
</span><span class='line'>
</span><span class='line'># cocos setup 
</span><span class='line'>    - cd ./cocos2d
</span><span class='line'>    - python download-deps.py --remove-download=yes
</span><span class='line'>    - python ./setup.py
</span><span class='line'>    - export COCOS_CONSOLE_ROOT=`pwd`/tools/cocos2d-console/bin
</span><span class='line'>    - export PATH=$PATH:$COCOS_CONSOLE_ROOT
</span><span class='line'>    - export COCOS_TEMPLATES_ROOT=`pwd`/templates
</span><span class='line'>    - export PATH=$PATH:$COCOS_TEMPLATES_ROOT
</span><span class='line'>    - export ANT_ROOT=/usr/share/ant/bin
</span><span class='line'>    - export PATH=$PATH:$ANT_ROOT
</span><span class='line'>    - printenv
</span><span class='line'>    - cd ..
</span><span class='line'>
</span><span class='line'>script:
</span><span class='line'>    - cocos compile -p android -j 8
</span><span class='line'>
</span><span class='line'>after_success:
</span><span class='line'>    - echo $TRAVIS_BRANCH
</span><span class='line'>    - echo $TRAVIS_PULL_REQUEST
</span><span class='line'>    - '[ "$TRAVIS_BRANCH" == "master" -a "$TRAVIS_PULL_REQUEST" == "false" ] && curl -F "file=@./bin/debug/android/KonaReflection-debug.apk" -F "token=${DEPLOYGATE_TOKEN}" -F "message=Deploy from Travis CI" https://deploygate.com/api/users/pankona/apps'</span></code></pre></td></tr></table></div></figure>

<h3 id="前回からの変更点（apkアップロードのために追加した部分）">前回からの変更点（APKアップロードのために追加した部分）</h3>

<p>前回から増えたり変更したりしたのは以下。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>env:
</span><span class='line'>  global:
</span><span class='line'>    secure: "TeSR8JLJd2Z0erCxcgLinC+me5SfwpgcCNwiTsqXn09erOgos2+mUbVQaSyo7Bw4OF4TmNpejX+jETd/lL4fTiWRDw6NW/cqEelk57fXJ5mmf5ey+tB1EkMFwd8x7Fw2vBe4xtO8KeohI6D1Gtu1qTYU9t9x4bhAd4qL15Y5osE="</span></code></pre></td></tr></table></div></figure>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- '[ "$TRAVIS_BRANCH" == "master" -a "$TRAVIS_PULL_REQUEST" == "false" ] && curl -F "file=@./bin/debug/android/KonaReflection-debug.apk" -F "token=${DEPLOYGATE_TOKEN}" -F "message=Deploy from Travis CI" https://deploygate.com/api/users/pankona/apps'</span></code></pre></td></tr></table></div></figure>

<p>後者の部分で、<code>${DEPLOYGATE_TOKEN}</code>という環境変数を参照しているが、これを設定しているのが前者の部分。</p>

<h3 id="deploygate_tokenの暗号化">DEPLOYGATE_TOKENの暗号化</h3>

<p>以下のコマンドでDeployGateのAPI Keyを暗号化する。</p>

<p><code>$ gem install travis</code> # travisコマンドを使えるようにする。<br>
<code>$ travis encrypt DEPLOYGATE_TOKEN={My DeployGate API Key}</code> # DeployGateで確認したAPI Keyを暗号化するコマンド（中括弧はいらない）。</p>

<p>このコマンドで得られた文字列をそのまま.travis.ymlに貼っつければOKである。</p>

<h3 id="いつアップロードするか">いつアップロードするか</h3>

<p>以下の条件を満たした場合のみ、APKのアップロードを行うようにした。<br>
これは、Pull Requestがmasterにマージされたとき、を意味している（つもり）。<br>
<code>&quot;$TRAVIS_BRANCH&quot; == &quot;master&quot; -a &quot;$TRAVIS_PULL_REQUEST&quot; == &quot;false&quot; ]</code></p>

<p>これをやっとかないと、ブランチにコミットをPUSHしたタイミングだったりPull Requestを作ったタイミングだったり、でアップロードが走る。<br>
個人的にはやり過ぎ感があったので、APKはmasterからだけ作ればいいやという制限を施した。</p>

<h3 id="これがそこそこ楽だと思います">これがそこそこ楽だと思います</h3>

<p>AndroidアプリにAPKをいちいち頑張って転送しなくても、開発中アプリをインストールすることができるようになった。<br>
ちなみに、アップロードされたAPKはDeployGateアプリ経由で取得することになる。</p>

<p>今回はここまで。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/19/cocos-with-travisci/">Cocos2d-x + Travis CI</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-19T02:26:14+00:00" pubdate data-updated="true">Apr 19<span>th</span>, 2015</time>
        
           | <a href="/blog/2015/04/19/cocos-with-travisci/#disqus_thread"
             data-disqus-identifier="http://pankona.github.io/blog/2015/04/19/cocos-with-travisci/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>引き続きcocos2d-xを使ってブロック崩しを作っている。<br>
かれこれ２ヶ月あまりが経過した。ほぼ通勤時間でのみ作っている。</p>

<p>いまのところの作業の流れとしては、<br>
* まずLinux向けにビルドして動作確認<br>
* 問題なさそうであれば、Android向けのビルドを実施<br>
* なんとかして実機にAPKを移し、インストールする</p>

<p>という手順なのであるが、実機へのデプロイがなかなか面倒である。<br>
基本的に電車内なので、ケーブルをスマホとPCに繋いで〜、というひと手間がなかなか面倒である。<br>
すると端末間のファイル共有だったり、原始的にメール越しにAPK共有、等があるが、、、やはり面倒である。</p>

<p>デプロイもっと楽にする手段としてDeployGateさんを使わせてもらうという手がある。<br>
これを用いると、変更をコミットするとそれだけで最新版APKがメールで送られてくるっていうようになるようである。</p>

<p>なので今回はこれを導入してみることにした。流れは以下のような感じになる予定である。<br>
* PC上にてcocos2d-xでアプリ作成。ソースをGithubにPush。<br>
* Travis CIでビルド。<br>
* ビルド成果物をTravis CIがDeployGateに送信。<br>
* DeployGateがわしのスマホにメールを送信（APK添付）。</p>

<p>以下、長文。</p>

<h2 id="cocos2d-x-+-travis-ci">cocos2d-x + Travis CI</h2>

<p>CI環境としてTravis CIをチョイスした。無料で使えるからである（Publicなリポジトリ限定かな）。<br>
初のTravis CI利用ということもあり、なかなかに躓いたというか知らんことが多かったので、備忘録を残す。</p>

<h3 id="そもそもtravis-ciに何をしてもらえるか">そもそもTravis CIに何をしてもらえるか</h3>

<p>ちょいちょい試してみたところ、以下のような感じである。</p>

<ul>
<li>GithubへのPushをトリガーにして自動的にビルド実施。

<ul>
<li>ビルドに限らず、任意のScriptを実行可能。自動テストなんかも行うようにするとなお吉。</li>
<li>ビルド前処理、後処理、など、割と細かくステージ分けがされている。</li>
</ul></li>
<li>ビルド失敗、成功の旨をメールにて通知。</li>
<li>masterだけでなく、他のブランチへのPushに対しても同様の処理をしてくれる。</li>
</ul>

<p>ざっくりだがこんな感じだろうと。無料で使えるにしては十分かな。</p>

<h3 id="さっそく設定する">さっそく設定する</h3>

<p>設定手順はこんな感じ。</p>

<ol>
<li>Travis CIのWebサイトにて、監視してほしいリポジトリの設定をする。</li>
<li>リポジトリのトップに .travis.yml を置く。</li>
<li>あとはソースをプッシュするだけ。</li>
</ol>

<p>(1)と(3)は別に問題ないと思われる。問題は(2)である。<br>
以下、.travis.ymlの内容について書く。</p>

<h3 id="ビルドパスした-.travis.yml-はこれ">ビルドパスした .travis.yml はこれ</h3>

<p>いかにもやっつけ感満載でありつつ、とりあえずビルドパスするところまでいけた。<br>
記念に貼り付けておく。もしかして誰かの役に立つことも願いつつ。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>language: android
</span><span class='line'>
</span><span class='line'># Handle git submodules yourself
</span><span class='line'>git:
</span><span class='line'>    submodules: false
</span><span class='line'>
</span><span class='line'>install:
</span><span class='line'># NDK configuration
</span><span class='line'>    - printenv
</span><span class='line'>    - echo `pwd`
</span><span class='line'>    - wget http://dl.google.com/android/ndk/android-ndk-r10d-linux-x86_64.bin
</span><span class='line'>    - chmod a+x android-ndk-r10d-linux-x86_64.bin
</span><span class='line'>    - ./android-ndk-r10d-linux-x86_64.bin -y | grep -v Extracting # because log will be too long!
</span><span class='line'>    - export NDK_ROOT=`pwd`/android-ndk-r10d
</span><span class='line'>    - echo $NDK_ROOT
</span><span class='line'>    - export PATH=$PATH:$NDK_ROOT
</span><span class='line'>    - echo $PATH
</span><span class='line'>
</span><span class='line'># Android SDK configuration
</span><span class='line'>    - export ANDROID_SDK_ROOT=/usr/local/android-sdk
</span><span class='line'>    - export PATH=$PATH:$ANDROID_SDK_ROOT/tools:$ANDROID_SDK_ROOT/platform-tools
</span><span class='line'>
</span><span class='line'># git submodule
</span><span class='line'># Use sed to replace the SSH URL with the public URL, then initialize submodules
</span><span class='line'>    - sed -i 's/git@github.com:/https:\/\/github.com\//' .gitmodules
</span><span class='line'>    - git submodule update --init --recursive
</span><span class='line'>
</span><span class='line'># cocos setup 
</span><span class='line'>    - cd ./cocos2d
</span><span class='line'>    - python download-deps.py --remove-download=yes
</span><span class='line'>    - python ./setup.py
</span><span class='line'>    - export COCOS_CONSOLE_ROOT=`pwd`/tools/cocos2d-console/bin
</span><span class='line'>    - export PATH=$PATH:$COCOS_CONSOLE_ROOT
</span><span class='line'>    - export COCOS_TEMPLATES_ROOT=`pwd`/templates
</span><span class='line'>    - export PATH=$PATH:$COCOS_TEMPLATES_ROOT
</span><span class='line'>    - export ANT_ROOT=/usr/share/ant/bin
</span><span class='line'>    - export PATH=$PATH:$ANT_ROOT
</span><span class='line'>    - printenv
</span><span class='line'>
</span><span class='line'>script:
</span><span class='line'>    - cd ..
</span><span class='line'>    - cocos compile -p android -j 8</span></code></pre></td></tr></table></div></figure>

<p>躓き備忘録を以下に記しておく。</p>

<h4 id="travis-ciは何で動いてるんだろ">Travis CIは何で動いてるんだろ</h4>

<p>Ubuntu 14.04（64bit）らしい。<br>
なので各種Linuxのコマンドは使える。</p>

<h4 id="cocosコマンド使えるようにする？">cocosコマンド使えるようにする？</h4>

<p>cocos2d-xの開発では、cocosコマンドによるビルドを使うのが便利である。<br>
ただし、ちょっと環境構築が面倒な一面もある。</p>

<p>上記のymlでは、結果的にcocosコマンドを使える状態にしている。<br>
「Travis CIはAndroidのビルドをサポートしている」ようなのだが、なのでもしかしたら、<br>
cocosコマンドを使えるようにしなくても、Ant、ndk-buildあたりでなんとかできるのかもしれない。</p>

<p>と思ったのだが、どうやらNativeビルドには対応していないようである（あらかじめ用意されてはいない）。<br>
なので、おとなしくcocosコマンドを使う方針で設定してみた。</p>

<h4 id="ndkを解凍するときにtravis-ciがerror-137で終わる">NDKを解凍するときにTravis CIがerror 137で終わる</h4>

<p>上記ymlでいうところの、以下の箇所を実行するとerror 137を報告してビルドが失敗に終わることがあった。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- wget http://dl.google.com/android/ndk/android-ndk-r10d-linux-x86_64.bin
</span><span class='line'>- chmod a+x android-ndk-r10d-linux-x86_64.bin
</span><span class='line'>- ./android-ndk-r10d-linux-x86_64.bin -y | grep -v Extracting # because log will be too long!</span></code></pre></td></tr></table></div></figure>

<p>解凍時にログをリダイレクトしているが、これをしないとログが大量に出過ぎることが原因でTravis CIに怒られ、ビルドが失敗に終わる。<br>
それとは別に、解凍にメモリをくいすぎて、いわゆるメモリショートでプロセスが殺されるのがerror 137の原因らしい。。。</p>

<p><code>sudo: required</code> をファイルの冒頭に書いていたのであるが、それを消したらerror 137は解消した。<br>
意味不明だが、回避策もよくわからないのでもう追っかけるのはやめた。。。</p>

<h4 id="android-sdkはあえて用意しなくていい">Android SDKはあえて用意しなくていい</h4>

<p>NDKは自前で用意する必要があるが、Android SDKはTravis CI側で用意してくれているので、あえて自前で用意しなくてもいい。</p>

<p>というか、Android SDKをダウンロード → Update SDK の流れを実施すると、今度はストレージ容量を圧迫してしまうため、<br>
後続の処理（git submodule）実行時にストレージ容量不足でビルドが失敗に終わる。<br>
有料にすれば解決するのかな？とりあえずわしの環境ではAndroid SDKを自前で準備することは出来なかった。。</p>

<h4 id="gitスキームを用いているsubmodule取得に失敗する">gitスキームを用いているsubmodule取得に失敗する</h4>

<p>SSH鍵の関係で、gitスキームを用いているsubmoduleの取得に失敗する。<br>
なのでgitを用いてる部分はhttpsに無理やり書き換えている。以下の部分である。<br>
涙ぐましい。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Use sed to replace the SSH URL with the public URL, then initialize submodules
</span><span class='line'>    - sed -i 's/git@github.com:/https:\/\/github.com\//' .gitmodules</span></code></pre></td></tr></table></div></figure>

<h4 id="環境変数設定を頑張る">環境変数設定を頑張る</h4>

<p>cocos2d設定の過程で<code>setup.py</code>を実行するところがあるが、こいつは<code>.bashrc</code>を書き換える。<br>
<code>.bashrc</code>内に<code>export</code>文がいくつか追加される。本来、<code>source ~/.bashrc</code>等とやれば環境変数が有効になるのであるが、、、<br>
Travis CIのScript上では効かないので、しかたなく<code>.bashrc</code>に追記されるものと同等の設定を<code>.travis.yml</code>にて実施した。<br>
以下の部分である。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- export COCOS_CONSOLE_ROOT=`pwd`/tools/cocos2d-console/bin
</span><span class='line'>- export PATH=$PATH:$COCOS_CONSOLE_ROOT
</span><span class='line'>- export COCOS_TEMPLATES_ROOT=`pwd`/templates
</span><span class='line'>- export PATH=$PATH:$COCOS_TEMPLATES_ROOT
</span><span class='line'>- export ANT_ROOT=/usr/share/ant/bin
</span><span class='line'>- export PATH=$PATH:$ANT_ROOT</span></code></pre></td></tr></table></div></figure>

<p>ここまでいくと、Travis CI上で<code>cocos</code>コマンドが使えるようになる。<br>
<code>cocos compile -p android -j 8</code>でビルド実行。APKが生成される（デバッグ版）はずである。</p>

<p>成果物がでてくるところまできたので、Travis CIの設定はひとまず以上とした。<br>
おかげさまで、リポジトリにTravis CIバッヂを貼ることができた。</p>

<p><a href="https://github.com/pankona/KonaReflection">https://github.com/pankona/KonaReflection</a></p>

<h4 id="deploygateさんへのデプロイは">DeployGateさんへのデプロイは</h4>

<p>ビルド成功の後、curlコマンドでAPKをDeployGateさんへ送信すればいい模様。<br>
できたらまた躓きポイントを載せていこうと思う。<br>
追記：DeployGateさんへのアップロードについては<a href="http://pankona.github.io/blog/2015/04/22/travis-ci-with-deploygate/">次回記事</a>も見てね。</p>

<p>今回はここまで。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/03/11/cocos2d-initial/">Cocos2d-xをやってみている</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-03-11T11:29:27+00:00" pubdate data-updated="true">Mar 11<span>th</span>, 2015</time>
        
           | <a href="/blog/2015/03/11/cocos2d-initial/#disqus_thread"
             data-disqus-identifier="http://pankona.github.io/blog/2015/03/11/cocos2d-initial/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>2015.03.07に娘が生まれました。<br>
これからも頑張ります。近況を記す。</p>

<h3 id="cocos2d-xを始めてみたのである">cocos2d-xを始めてみたのである</h3>

<p>昨年末からあまりRaspberry Piを触れない環境におかれていたもので、<br>
何か手軽にプログラミングをエンジョイできないかと思って、探して見た結果がcocos2d-x。<br>
Unityじゃなくてcocos2d-xにしたのは、Linux向けの開発環境があるからである。<br>
Unityやってみたかったけど、LinuxでやりたかったらWineを使え、みたいな感じになっているようで、<br>
そんなことこっちから願い下げだ、ということで、cocos2d-x。<br>
C++で書けて、これから触ってみようと思っているLuaとも相性がいい様子で、願ったり叶ったりである。</p>

<h3 id="いま作っているもの">いま作っているもの</h3>

<p>なかなか始めてみると面白い。<br>
とりあえずわかりやすいところから馴染んでいこうということで、<br>
ブロック崩しを題材にして制作に励んでいるところ。リポジトリはこちら。<br>
<a href="https://github.com/pankona/KonaReflection">KonaReflection</a><br>
プロジェクト名は3日程真剣に考えた挙句これである。</p>

<p>開発環境は、愛機のVaio Pro 13（Arch Linux）と職場Mac Book Proの両刀で実践中。<br>
デプロイターゲットはLinux、Mac（いずれもデバッグ目的）、そしてAndroid。<br>
※ 職場MBPを使っているが、ちゃんと仕事はしている。暇なときにやっている。</p>

<p>どこまで作るかという話もあるが、とりあえず誰かを楽しませることが出来るレベルまで作ろうかと思う。<br>
せっかく作るなら、一応、体としてはやりきりたいではないか。</p>

<h3 id="longest-streakを13に伸ばす">Longest Streakを13に伸ばす</h3>

<p>なんやかやあって途絶えてしまったが、Longest Streakは13まで更新した。<br>
そんなもん伸ばして何になるの、というのもわかるが、ちょっとでも、毎日ソース更新しなきゃ、という気持ちになるのであれば、<br>
意味がなくもないんじゃないかと思いつつ。また仕切りなおして伸ばしていこう。</p>

<h3 id="cocos2d-xを使ったアプリをeclipseで開発できるようにした">cocos2d-xを使ったアプリをEclipseで開発できるようにした</h3>

<p>Android向け、という話ではそこそこ記事があるが、ことLinux向けで開発環境構築というと記事がなかなかない。<br>
しかし出来るようになった。Eclipse＋CDT＋諸々設定（←ここがめんどい）。<br>
設定方法は別の記事としてまとめようと思う。cocos2d-x＋Eclipse＋Linux向けビルド、の体。</p>

<h3 id="vimでも開発できるように調整した">vimでも開発できるように調整した</h3>

<p>いっときEclipseを用いてcocos2d-xの開発環境を作ることを諦めかけた（めんどすぎた）のだが、<br>
そのとき、Vimだけでやれるように開発環境構築を頑張ってみたのである。<br>
割といい具合になったのでこっちもそのうち記事にしてみようと思う。<br>
Vim＋Syntastic＋NeoComplete＋Clang_Complete、といった組み合わせである。<br>
だけどまあ結局はEclipseを使いそうである。事足りてしまうし、むしろvrapperがあればそこそこ快適である。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/28/300hot-per-month/">月間300ヒットを達成していた</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-28T12:44:18+00:00" pubdate data-updated="true">Jan 28<span>th</span>, 2015</time>
        
           | <a href="/blog/2015/01/28/300hot-per-month/#disqus_thread"
             data-disqus-identifier="http://pankona.github.io/blog/2015/01/28/300hot-per-month/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>12月のことであるが、実は月間300ヒットを達成していた。<br>
うち250ヒットは自分の手によるもの、、、とかそういうことではなく、<br>
概ね自分以外の方々によって、月間300ヒットを達成できたのである。<br>
300ヒット。たかが300ヒット。されど300ヒット。 一日平均10人。</p>

<p>これからもほそぼそ、ぼちぼち、書いていこうと思う。<br>
学んだことをアウトプットするのが大事だと誰か偉い人も言っておった。私もそう思う。<br>
書いたことによって、誰かひとりでも何かの助けになればと願いつつ。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/28/raspi-autologin/">Raspberry Piでログインを自動化、ついでに現在のIP表示させてみる</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-28T12:10:39+00:00" pubdate data-updated="true">Jan 28<span>th</span>, 2015</time>
        
           | <a href="/blog/2015/01/28/raspi-autologin/#disqus_thread"
             data-disqus-identifier="http://pankona.github.io/blog/2015/01/28/raspi-autologin/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>しばらく愛用のVaio Proをいじる時間がとれなかったもんで、新しい記事をポストできずにおった。<br>
実におよそ2ヶ月ぶりの新規記事。新年あけましておめでとうございます。<br>
今年もぼちぼちでやっていきます。目指せ100記事。</p>

<h3 id="raspberry-pi起動時に、pitftにipアドレスを表示させる">Raspberry Pi起動時に、PiTFTにIPアドレスを表示させる</h3>

<p>いま自分のとこで扱っているRaspberry Piは、基本的に画面を接続せず、操作はネットワーク越し（SSH）に行う前提にしている。<br>
そのため、SSHによるログインにあたってはRaspberry PiのIPアドレスを知る等してネットワーク的にリーチする必要がある。</p>

<p>いままではarpをしてみたりpingをブロードキャストに投げてみたり、ホストネームを打ってみたり、色々やっていたのであるが、<br>
いまひとつうまく行かないことがあって、そのたびにトラブルシューティングのために、結局画面を接続する必要が生じていた。<br>
実に間抜け感を感じるわけである。</p>

<p>PiTFTをくっつけた、というのはちょっと前の記事で書いたところなのであるが、<br>
じゃあとりあえず、Raspberry Pi起動時にこいつに現在のIPアドレスを出力してみれば便利なのでは、と思ったのである。<br>
IPアドレスさえわかれば、だいたいにおいてSSH接続できるしね。</p>

<p>方法は、<br>
* 自動でログインさせる<br>
* ログイン時にifconfigし、IPアドレスの部分を抽出しつつ、コンソール（PiTFT）出力<br>
といった感じ。以下、詳細。</p>

<h3 id="自動ログインさせる">自動ログインさせる</h3>

<p>ちなみに私が扱っているRaspberry PiにはArch Linuxが載っている。<br>
Raspbian、Pidora等とは設定が違うと思われるので注意されたし。<br>
Arch Linuxなので、現在のところ起動時の仕組みはSystemdが用いられている。</p>

<p>Systemdにおける自動ログインの設定は、例によってArch Wikiに載っていたのでそれを参照した。<br>
ここを参照。→  <a href="https://wiki.archlinux.org/index.php/Automatic_login_to_virtual_console_(%E6%97%A5%E6%9C%AC%E8%AA%9E)%5Dx">Automatic login to virtual console</a><br>
仮想コンソールの章を、騙されたと思ってそのまま設定し、そんで再起動してやればもう自動ログインできているはずである。</p>

<h3 id="ログイン時にifconfigし、ipアドレス部分を抽出">ログイン時にifconfigし、IPアドレス部分を抽出</h3>

<p>自動ログインできたらあとは簡単で、.bashrcにでもIPアドレス出力用の何かを書いてあげればOKである。</p>

<figure class='code'><figcaption><span>.bashrc </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ifconfig | grep inet</span></code></pre></td></tr></table></div></figure>

<p>これでいいや、という感じで書いておいた。</p>

<p>ただ、起動と同時に自動ログイン → IPアドレス表示、だと、IPを取れてないことがあって具合が良くない。<br>
そのため、上記IPアドレス取得の前に、ちょっとだけsleepなんかを入れてあげるとそのへんは心配がなくなる。</p>

<figure class='code'><figcaption><span>.bashrc </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sleep 5
</span><span class='line'>ifconfig | grep inet</span></code></pre></td></tr></table></div></figure>

<p>こんな具合である。</p>

<h3 id="ipアドレスがわかるようになったがpitftがもったいない感">IPアドレスがわかるようになったがPiTFTがもったいない感</h3>

<p>PiTFTだとちょっとやりすぎなので、もっと小さい画面モジュールでやってもいいと思う。<br>
というか早く無線化しようね。次の目標は無線化です。それでは。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/25/remote-ltika/">Raspberry Piにて、リモートからLチカさせてみた</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-11-25T13:16:43+00:00" pubdate data-updated="true">Nov 25<span>th</span>, 2014</time>
        
           | <a href="/blog/2014/11/25/remote-ltika/#disqus_thread"
             data-disqus-identifier="http://pankona.github.io/blog/2014/11/25/remote-ltika/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Raspberry Piをリモートから制御する第一歩として、<br>
ネットワーク越しに、AndroidアプリからLチカさせてみる、をやってみた。<br>
いまのところ実にしょうもないレベルであるが、最初は誰もがしょうもなかったと言い聞かせつつ、<br>
やったことを公開しつつ、どんなあんばいだったか記録しておこうと思う。<br>
ちなみに、ここでいっているLEDとは、Raspberry Piボード上のLED &quot;ACT&quot; を指している。<br>
ブレッドボードやらそういった類の何かは使っていない。</p>

<h3 id="構成">構成</h3>

<ul>
<li>Raspberry Pi （OSはArch Linux） 有線LAN接続

<ul>
<li>Railsが動いていて、REST APIを公開している。</li>
<li>REST APIを叩くことで、LEDのON/OFFを制御するスクリプトが動作し、Lチカを実現する。</li>
</ul></li>
<li>Androidアプリ

<ul>
<li>ボタンが2個ついてるだけの超絶シンプルアプリ</li>
<li>ONボタンを押すとLEDを点けるほうのREST APIを叩きにいく。</li>
<li>同様に、OFFボタンを押すとLEDを消すREST APIを叩きにいく。</li>
<li>対向機のIPアドレスはまさかのハードコーディング。</li>
</ul></li>
</ul>

<h3 id="ソースコード">ソースコード</h3>

<ul>
<li>Raspberry Pi側のソースコードは<a href="https://github.com/pankona/raspi_remote_blink">こちら</a>。Railsアプリ。</li>
<li>Android側のアプリは後ほどアップロード（手元になかった）。</li>
</ul>

<h3 id="今後に向けてメモ">今後に向けてメモ</h3>

<ul>
<li>Railsアプリは、スクリプトへのパスがハードコードされていたりしてだいぶ恥ずかしいので、そのうち直す。</li>
<li>というかファイルI/OすればLチカできることがわかったので、もはやスクリプトを使う必要はなかった。そのうち直す。</li>
<li>応用して、自動草花への水やり機の作成を目論んでおく。できたら画像と共にアップロードしよう。</li>
<li>カメラと合わせて、水やりしつつ、草の成長記録をツイッターに投稿する、というのもいいかもしれない。</li>
<li>ツイッター越しに命令（水やり、写真撮影、等）を発行できるようにしてもいいかもしれない。</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/01/dokusho-meter/">Octopressカスタマイズで読書メーターのブログパーツを追加</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-10-01T13:41:26+00:00" pubdate data-updated="true">Oct 1<span>st</span>, 2014</time>
        
           | <a href="/blog/2014/10/01/dokusho-meter/#disqus_thread"
             data-disqus-identifier="http://pankona.github.io/blog/2014/10/01/dokusho-meter/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>たまにはブログのカスタマイズをしてみる。<br>
今回は読書メーターのブログパーツを追加してみた。</p>

<p>サイドバーに「最近読んだ本」なんてのが現れるようにしてみた。<br>
文字ばっかだったブログにちょっと賑やかし感があって良い。</p>

<p>例によって備忘録的にやり方を残しておく。<br>
Octopressに読書メーターのブログパーツを追加する方法。</p>

<h3 id="読書メーターのアカウントを取得する">読書メーターのアカウントを取得する</h3>

<p><a href="http://book.akahoshitakuya.com/">読書メーターのウェブページ</a>からどうぞ。</p>

<h3 id="ブログパーツを選ぶ">ブログパーツを選ぶ</h3>

<p>読書メーターにログイン後、マイページに行ってみると、<br>
<strong>「ブログパーツ」</strong>と書いてあるところがある。<br>
そこを見ると各種ブログパーツを見つけることが出来る。</p>

<h3 id="octopressをカスタマイズして、サイドバーに出るように">Octopressをカスタマイズして、サイドバーに出るように</h3>

<p>ここからはOctopress側の編集。</p>

<h4 id="読書メーター用のhtmlを書く。">読書メーター用のHTMLを書く。</h4>

<p>中身は上記ブログパーツの内容をコピペしたものだが。<br>
ブログパーツとして「最近読んだ本」をチョイス。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;section&gt;
</span><span class='line'>&lt;a href="http://book.akahoshitakuya.com/u/{人によって違うID}" title="{人の名前}の最近読んだ本"&gt;&lt;img src="http://img.bookmeter.com/bp_image/640/509/{人によって違うID}.jpg" border="0" alt="{人の名前}の最近読んだ本"&gt;&lt;/a&gt;
</span><span class='line'>&lt;/section&gt;</span></code></pre></td></tr></table></div></figure>

<h4 id="_config.ymlを編集して、サイドバーにパーツを追加">_config.ymlを編集して、サイドバーにパーツを追加</h4>

<p>_config.ymlのdefault_asidesを変更。読書メーター用HTMLファイルを指定。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>default_asides: [custom/asides/about.html, asides/recent_posts.html, asides/github.html, asides/delicious.html, 
</span><span class='line'>                 asides/pinboard.html, asides/googleplus.html, custom/asides/tag_cloud.html, custom/asides/category_list.html,
</span><span class='line'>                 custom/asides/dokusho_meter.html]</span></code></pre></td></tr></table></div></figure>

<h4 id="deployしたら完了">deployしたら完了</h4>

<p><code>bundle exec rake gen_deploy</code> 的なことをやってデプロイする。</p>

<h3 id="ここまでで">ここまでで</h3>

<p>最近読んだ本がサイドバーに表示されるように。<br>
ITっぽい本を並べたりすると、なんとなく技術的なブログな雰囲気が出て、<br>
とてもいいんではないでしょうか。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/09/14/histryback-by-swipe-on-firefox/">二本指スワイプに戻る／進むを割り当てる方法 for Firefox on Arch Linux</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-14T15:30:08+00:00" pubdate data-updated="true">Sep 14<span>th</span>, 2014</time>
        
           | <a href="/blog/2014/09/14/histryback-by-swipe-on-firefox/#disqus_thread"
             data-disqus-identifier="http://pankona.github.io/blog/2014/09/14/histryback-by-swipe-on-firefox/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>ブラウザはFirefoxを好んで使っている。<br>
VimperatorとかPentadactylがあるおかげである。</p>

<p>いままで放置していた問題があって、それは二本指スワイプの挙動設定。</p>

<p>二本指で左右にスワイプしたときに、ヒストリーバック・ヒストリーフォワード、<br>
いわゆる「戻る」「進む」をやってほしいんだけど、これの設定がいまいちわからず、放置していた。<br>
ようやく設定方法がわかったので記しておく。そっこー忘れそうであるので。</p>

<p>ちなみに、「on Arch Linux」と題しているが、おそらくArchに限らないLinux全般の話ではないかと想像。<br>
UbuntuとArch Linux、どちらのFirefoxでもデフォルト設定では横方向二本指スワイプが仕事をしてくれなかったので。</p>

<p>では、以下設定手順。</p>

<h2 id="synclientの確認と設定">synclientの確認と設定</h2>

<p>そもそもタッチパッドのドライバーレベルで横方向スクロールが無効になっている可能性がある。というかなってた。<br>
なので、確認方法と設定変更方法。</p>

<h4 id="synclientコマンドを打って水平方向二本指スクロールの設定を確認する">synclientコマンドを打って水平方向二本指スクロールの設定を確認する</h4>

<p>以下のコマンドで現在の設定を確認できる。</p>

<p><code>$ synclient</code></p>

<p>ずらずらっと出てくる内容のうち、<code>HorizTwoFingerScroll</code> が確認対象の項目。<br>
値が「0」だったら無効になっている。有効にしない限り、いくら頑張って横スワイプしても効かない。</p>

<h4 id="synclientコマンドで水平方向二本指スクロールを有効にする">synclientコマンドで水平方向二本指スクロールを有効にする</h4>

<p>上の確認で有効だったらここは飛ばしてOK。無効だった場合、有効にするのは以下のコマンド。</p>

<p><code>$ synclient HorizTwoFingerScroll=1</code></p>

<p>synclientのほうはこれでOK。</p>

<h2 id="firefoxの設定">Firefoxの設定</h2>

<p>さらにFirefoxの設定を変えてやる必要がある。<br>
設定内容は<a href="https://wiki.archlinux.org/index.php/Touchpad_Synaptics">Touchpad Synaptics - Arch Linux Wiki</a>、Firefox 17.0 and laterの項を参考にした。</p>

<p>about:configを開く。設定内容は以下。</p>

<h4 id="マウスホイールのアクションを変更する">マウスホイールのアクションを変更する</h4>

<p><code>mousewheel.default.action.override_x = 2</code> とした。<br>
あんまりよく調べていないが、「2」が戻るアクションに対応している数字らしい。</p>

<h4 id="スワイプ方向を逆にする">スワイプ方向を逆にする</h4>

<p>デフォルトでは、左スワイプが「進む」、右スワイプが「戻る」になっている。<br>
逆な気がする。設定してこれを逆転させる。</p>

<p><code>mousewheel.default.delta_multiplier_x = -100</code> とした。</p>

<h4 id="感度を落とす">感度を落とす</h4>

<p>デフォルトではものすごく感度がよい。<br>
良すぎてしまって縦スワイプがちょっと横にぶれただけで戻ったり進んだりする。<br>
やりにくいので感度を落とす。</p>

<p><code>mousewheel.default.delta_multiplier_x = -10</code> とした。</p>

<h2 id="ここまでやって">ここまでやって</h2>

<p>とりあえず望む形（二本指で左スワイプで戻る、右スワイプで進む）に設定できた。結構ハードルあった。。<br>
ちなみにこれ、Mac OS向けFirefoxならデフォルトの挙動な模様。何の差なのか。。。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/23/raspi-touch-panel/">PiTFTのタッチパネルを動作させる</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-07-23T12:54:58+00:00" pubdate data-updated="true">Jul 23<span>rd</span>, 2014</time>
        
           | <a href="/blog/2014/07/23/raspi-touch-panel/#disqus_thread"
             data-disqus-identifier="http://pankona.github.io/blog/2014/07/23/raspi-touch-panel/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>前回に引き続き、PiTFTの話題。</p>

<p>前回でPiTFTにコンソール画面だったりXの画面だったりを出力させるところまでいった。<br>
タッチパネルの設定がまだだったので、手順を簡単に記しておく。</p>

<p>例によって、Raspberry PiにはArch Linuxが載っている前提。</p>

<h3 id="タッチパネルのドライバーをロードする">タッチパネルのドライバーをロードする</h3>

<p>前回、FBTFTがビルトインされているカーネルを以下のコマンドでインストールした。</p>

<p><code>$ sudo -E REPO_URI=https://github.com/notro/rpi-firmware BRANCH=builtin rpi-update</code></p>

<p>これが正しく入っていれば、タッチパネルのドライバもカーネルに含まれているはず。<br>
ただし、画面に何かを表示させる時と異なり、手動でドライバをロードする必要がある。</p>

<p>以下のコマンドで、タッチパネルのドライバをロードする。</p>

<p>@@@@ 忘れたのであとで追記する @@@@</p>

<p>基本的にはこれだけで動作すると思われる。<br>
例によって<a href="https://github.com/notro/fbtft/wiki">notroさんのところのWiki</a>に載っている内容だが、<br>
notroさんのところは充実しすぎて逆に迷う気がするので、備忘録的に残しておくことにする。。</p>

<h3 id="動いているか確かめる方法">動いているか確かめる方法</h3>

<p>evtestを用いて確かめられる。<br>
evtestを起動したのちにタッチパネルをぐりぐり触ってみると、<br>
タッチイベントの詳細がコンソールに出力される。</p>

<p>また、正常にドライバがロードされると、<code>/dev/input/touchpanel</code>なるファイルが現れるはずである。<br>
ちなみにこれはeventXへのシンボリックリンクになっている。<br>
このファイルの有無でもドライバのロードが正しく行われたか判断できると思われる。</p>

<h3 id="要追記事項">要追記事項</h3>

<ul>
<li>ドライバロードのコマンドをちゃんと確認する。</li>
<li>キャリブレーション（回転した画面への対応）の方法。</li>
</ul>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/3/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  
    <img src="http://www.gravatar.com/avatar/20c3394adc3ea5485023625de24b8486" alt="Gravatar of pankona " title="Gravatar of pankona" align="left" style="margin-right:10px;" />
  
  名前は pankona です。Manjaro on Vaio Pro 13 で日々遊んでます。西武新宿線ユーザ。Go 言語好き。
  <br clear="left">
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2017/06/01/golangtokyo-6/">golang.tokyo#6@DeNA</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/03/01/golangtokyo-4/">golang.tokyo#4@eureka</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/12/14/jp-input-on-gnome-app/">GNOMEアプリ上で日本語入力できなくなったときの対処メモ</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/12/12/golangtokyo-2/">golang.tokyo#2@はてな</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/11/14/usb-wifi-dongle/">Linux で 無線LAN の USB ドングルを使う</a>
      </li>
    
  </ul>
</section>




<section>
  <h1>Tag Cloud</h1>
    <span id="tag-cloud"><a href='/blog/categories/archlinux' style='font-size: 151.42857142857144%'>ArchLinux(6)</a> <a href='/blog/categories/cocos2d-x' style='font-size: 125.71428571428572%'>cocos2d-x(3)</a> <a href='/blog/categories/golang' style='font-size: 134.28571428571428%'>golang(4)</a> <a href='/blog/categories/octopresskasutamaizu' style='font-size: 134.28571428571428%'>Octopressカスタマイズ(4)</a> <a href='/blog/categories/raspberrypi' style='font-size: 160.0%'>RaspberryPi(7)</a> <a href='/blog/categories/sofalseta' style='font-size: 134.28571428571428%'>その他(4)</a> <a href='/blog/categories/gazietuto' style='font-size: 125.71428571428572%'>ガジェット(3)</a> </span>
</section>
<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/categories/archlinux/'>ArchLinux (6)</a></li><li><a href='/blog/categories/cocos2d-x/'>cocos2d-x (3)</a></li><li><a href='/blog/categories/golang/'>golang (4)</a></li><li><a href='/blog/categories/octopresskasutamaizu/'>Octopressカスタマイズ (4)</a></li><li><a href='/blog/categories/raspberrypi/'>RaspberryPi (7)</a></li><li><a href='/blog/categories/sofalseta/'>その他 (4)</a></li><li><a href='/blog/categories/gazietuto/'>ガジェット (3)</a></li></ul>
</section>
<section>
<a href="http://bookmeter.com/u/508456" title="pankonaの最近読んだ本"><img src="http://img.bookmeter.com/bp_image/640/509/508456.jpg" border="0" alt="pankonaの最近読んだ本"></a>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - pankona -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'pankona-mcm';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
